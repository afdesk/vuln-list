{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20222928",
  "Version": "636",
  "Metadata": {
    "Title": "option refcount overflow when leasequery is enabled leading to dhcpd abort (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2022-2928",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2022-2928"
      }
    ],
    "Description": "DOCUMENTATION: An integer overflow vulnerability was found in the DHCP server. When the \"option_code_hash_lookup()\" function is called from \"add_option()\", it increases the option's \"refcount\" field. However, there is not a corresponding call to \"option_dereference()\" to decrement the \"refcount\" field. The \"add_option()\" function is only used in server responses to lease query packets. Each lease query response calls this function for several options. Hence, a DHCP server configured with \"allow lease query,\" a remote machine with access to the server, can send lease queries for the same lease multiple times, leading to the \"add_option()\" function being called repeatedly. This issue could cause the reference counters to overflow and the server to abort or crash. \n            STATEMENT: Vulnerable servers are network accessible to an attacker and configured to allow and process lease queries.\n\nInternally, reference counters are integers and thus overflow at 2^31 references, so even at 1000 lease query responses per second, it would take more than three weeks to crash the server.\n            MITIGATION: Possible workaround - Disable lease query on the server for DHCPv4 or restart the server periodically.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2023-05-16"
      },
      "Cves": [
        {
          "CveID": "CVE-2022-2928",
          "Cvss3": "6.5/CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Cwe": "CWE-190",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2022-2928",
          "Public": "20221005"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:8",
        "cpe:/a:redhat:enterprise_linux:8::appstream",
        "cpe:/a:redhat:enterprise_linux:8::crb",
        "cpe:/a:redhat:enterprise_linux:8::highavailability",
        "cpe:/a:redhat:enterprise_linux:8::nfv",
        "cpe:/a:redhat:enterprise_linux:8::realtime",
        "cpe:/a:redhat:enterprise_linux:8::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:8::sap",
        "cpe:/a:redhat:enterprise_linux:8::sap_hana",
        "cpe:/a:redhat:enterprise_linux:8::supplementary",
        "cpe:/o:redhat:enterprise_linux:8",
        "cpe:/o:redhat:enterprise_linux:8::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dhcp-server is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222928001"
                  },
                  {
                    "Comment": "dhcp-server is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222928002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dhcp is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222928003"
                  },
                  {
                    "Comment": "dhcp is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222928004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dhcp-relay is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222928005"
                  },
                  {
                    "Comment": "dhcp-relay is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222928006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dhcp-client is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222928007"
                  },
                  {
                    "Comment": "dhcp-client is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222928008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dhcp-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222928009"
                  },
                  {
                    "Comment": "dhcp-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222928010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dhcp-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20222928011"
                  },
                  {
                    "Comment": "dhcp-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20222928012"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}